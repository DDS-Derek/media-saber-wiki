---
title: 下载器站点标签
article: false
tags: 
  - 修仙秘籍
  - 下载器
  - 标签
  - 站点
categories: 
editor: markdown
permalink: /docs/cultivation_secrets/downloader_site_tag/
date: 2023-09-27 12:16:17
---

# 🏷️ 下载器站点标签

**下载器站点标签** 是一个自动为种子添加对应站点标签的插件，通过解析种子的Tracker地址自动识别站点名称并添加标签，方便统计和管理各站点的种子。

## ⚙️ 功能特点

### 🎯 自动标签
- **智能识别**：通过Tracker地址自动识别站点名称
- **批量处理**：支持同时处理多个下载器的种子
- **标签定制**：支持自定义标签前缀
- **状态过滤**：可选择处理特定状态的种子

### 📊 灵活配置
- **下载器选择**：支持多选下载器同时处理
- **条件过滤**：支持多种过滤条件
- **数量控制**：可限制单次处理的种子数量
- **覆盖控制**：可选择是否覆盖已有标签

## 🚀 配置指南

### 基础配置

插件配置包含以下参数：

### 📋 必填参数

1. **下载器 (downloaders)**：
   - 选择要处理的下载器（可多选）
   - 支持qBittorrent和Transmission

### ⚙️ 可选参数

#### 执行控制
1. **执行周期 (cron)**：
   - 定时执行的Cron表达式
   - 默认：`0 2 * * *`（每天凌晨2点）
   - 留空则只能手动执行

2. **消息推送 (notice)**：
   - 任务执行完成后发送统计通知
   - 默认关闭

#### 处理条件
3. **仅处理已完成种子 (onlyCompleted)**：
   - 开启：只为已完成下载的种子添加标签
   - 关闭：为所有状态的种子添加标签
   - 默认关闭

4. **覆盖已有标签 (overwriteExist)**：
   - 开启：重新添加站点标签，即使已存在
   - 关闭：跳过已有相同站点标签的种子
   - 默认关闭

#### 标签设置
5. **标签前缀 (tagPrefix)**：
   - 添加到站点名称前的前缀
   - 例如：`site_` + `hdsky` = `site_hdsky`
   - 留空则直接使用站点名称作为标签

#### 数量控制
6. **单次最大处理数量 (maxProcessCount)**：
   - 单次任务最多处理的种子数量
   - 设置为0表示不限制
   - 默认：500

#### 过滤条件
7. **排除的Tracker (excludeTrackers)**：
   - 要排除的Tracker域名，多个用逗号分隔
   - 包含这些域名的种子将被跳过
   - 例如：`tracker1.com,tracker2.org`

8. **包含的种子状态 (includeStatuses)**：
   - 只处理指定状态的种子，多个状态用逗号分隔
   - 留空则处理所有状态的种子
   - 例如：`seeding,completed,uploading`

## 📖 使用说明

### 执行流程

1. **种子扫描**：
   - 连接到选定的下载器
   - 获取所有种子的详细信息
   - 包括Tracker列表、状态、标签等

2. **站点识别**：
   - 解析每个种子的Tracker地址
   - 从Tracker域名中提取站点名称
   - 生成对应的站点标签

3. **条件过滤**：
   - 应用状态过滤条件
   - 排除指定的Tracker
   - 检查数量限制

4. **标签处理**：
   - 检查是否已存在相同标签
   - 根据覆盖设置决定是否添加
   - 添加站点标签到种子

5. **结果统计**：
   - 统计处理结果
   - 发送通知（如开启）

### 标签规则

#### 站点名称提取
- **域名解析**：从Tracker URL中提取域名
- **站点识别**：去除常见前缀（如www、tracker等）
- **名称处理**：使用核心域名作为站点名称

#### 标签生成
- **无前缀**：直接使用站点名称（如`hdsky`）
- **有前缀**：前缀+站点名称（如`site_hdsky`）
- **去重处理**：避免重复添加相同标签

#### 示例说明
```
Tracker: https://tracker.hdsky.me/announce.php?passkey=xxx
站点名称: hdsky
标签前缀: site_
最终标签: site_hdsky

Tracker: http://announce.thddl.com:8080/announce.php
站点名称: thddl  
标签前缀: 无
最终标签: thddl
```

### 定时任务配置

#### Cron表达式示例

```bash
# 每天凌晨2点执行
0 2 * * *

# 每12小时执行一次
0 */12 * * *

# 每周日凌晨3点执行
0 3 * * 0

# 每月1日凌晨4点执行
0 4 1 * *
```

> 📖 **详细说明**：关于Cron表达式的完整语法和更多示例，请参考：[Cron表达式说明文档](/docs/other/cron_rule)

### 操作功能

#### 运行一次
- 立即执行一次站点标签任务
- 不受定时任务设置影响
- 可用于测试配置或手动处理

## ⚠️ 注意事项

### 使用建议

1. **首次使用**：
   - 建议先手动执行一次，确认效果
   - 检查生成的标签是否符合预期
   - 确认无误后再设置定时任务

2. **性能考虑**：
   - 设置合理的处理数量限制
   - 避免在下载器繁忙时执行
   - 大量种子时可能需要较长处理时间

3. **标签管理**：
   - 合理设置标签前缀，便于区分
   - 定期清理无用的标签
   - 避免标签过多影响管理

### 配置建议

1. **下载器选择**：
   - 根据实际需要选择下载器
   - 避免重复处理相同的种子
   - 考虑不同下载器的负载情况

2. **过滤条件**：
   - 使用状态过滤提高处理效率
   - 排除不需要的Tracker
   - 合理设置处理数量限制

3. **标签策略**：
   - 统一的标签前缀便于管理
   - 考虑是否需要覆盖已有标签
   - 根据使用习惯调整标签格式

### 故障排除

1. **标签未添加**：
   - 检查下载器连接状态
   - 确认种子状态符合过滤条件
   - 验证Tracker地址格式

2. **处理速度慢**：
   - 减少单次处理数量
   - 使用状态过滤减少处理范围
   - 检查网络连接情况

3. **标签重复**：
   - 检查覆盖设置
   - 确认标签前缀配置
   - 手动清理重复标签

## 📊 使用效果

### 处理统计
- **扫描种子数**：检查的种子总数
- **符合条件数**：满足处理条件的种子数
- **添加标签数**：成功添加标签的种子数
- **跳过数量**：因各种原因跳过的种子数

### 管理效果
- **站点分类**：通过标签快速识别种子来源
- **统计便利**：方便统计各站点种子数量
- **管理优化**：便于按站点进行种子管理

## 🔗 相关链接

- [修仙秘籍主页](/docs/cultivation_secrets/main/)
- [Cron表达式说明](/docs/other/cron_rule)
- [自动删种](/docs/cultivation_secrets/auto_delete_torrent/)
- [Tracker替换](/docs/cultivation_secrets/tracker_editor/)

---

🎯 **提示**：站点标签功能可以大大提升种子管理效率，建议首次使用时先手动执行确认效果。
