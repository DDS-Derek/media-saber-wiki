---
title: 自动删种
article: false
tags: 
  - 修仙秘籍
  - 下载管理
  - 种子
  - 删除
categories: 
editor: markdown
permalink: /docs/cultivation_secrets/auto_delete_torrent/
date: 2023-09-27 12:16:17
---

# 🗑️ 自动删种

**自动删种** 是一个基于多种条件自动删除下载器中种子的插件，支持按大小、分享率、时间、标签、路径、Tracker等条件灵活配置删种规则，帮助管理存储空间和保持下载器整洁。

## ⚙️ 功能特点

### 🎯 多条件删种
- **大小条件**：按文件大小范围删除种子
- **分享率条件**：基于上传下载比例删除
- **时间条件**：按下载时间或做种时间删除
- **标签条件**：根据种子标签删除
- **路径条件**：按保存路径匹配删除
- **Tracker条件**：根据Tracker地址删除
- **错误条件**：删除包含错误信息的种子

### 📊 灵活操作
- **删除种子**：仅删除种子文件，保留数据
- **删除种子和数据**：同时删除种子和下载的文件
- **正则表达式支持**：路径和Tracker支持正则匹配
- **组合条件**：支持多个条件同时满足

## 🚀 配置指南

### 基础配置

插件配置包含以下参数：

### 📋 必填参数

1. **下载器 (downloaderId)**：
   - 选择要管理的下载器
   - 支持qBittorrent和Transmission

2. **动作 (action)**：
   - **删除种子**：仅删除.torrent文件，保留下载数据
   - **删除种子和数据**：同时删除种子文件和下载的数据

### ⚙️ 可选参数

#### 大小条件
1. **最小体积(GB) (minSize)**：
   - 种子体积大于等于该值才满足条件
   - 与最大体积同时设置才生效

2. **最大体积(GB) (maxSize)**：
   - 种子体积小于等于该值才满足条件
   - 与最小体积同时设置才生效

#### 分享率条件
3. **最低分享率 (minRatio)**：
   - 分享率大于等于该值才满足条件
   - 例如：设置为1.0表示上传量≥下载量

#### 时间条件
4. **最少下载时间(分钟) (leastDownloadTime)**：
   - 下载时间大于等于该值才满足条件
   - 从种子添加到下载器开始计算

5. **最少做种时间(小时) (leastSeedTime)**：
   - 做种时间大于等于该值才满足条件
   - 未完成种子从添加时间开始计算
   - 完成种子从完成时间开始计算

#### 速度条件
6. **最大平均上传速度(KB/s) (maxAvgUploadSpeed)**：
   - 平均上传速度小于等于该值才满足条件
   - 用于删除上传速度过慢的种子

#### 过滤条件
7. **包含标签 (includeTags)**：
   - 包含所有指定标签的种子才满足条件
   - 多个标签用英文逗号分隔
   - 例如：`tag1,tag2,tag3`

8. **包含保存路径 (includeSavePath)**：
   - 保存路径匹配成功的种子才满足条件
   - 支持正则表达式
   - 例如：`/downloads/movies/.*`

9. **包含Tracker (includeTracker)**：
   - Tracker地址匹配成功的种子才满足条件
   - 支持正则表达式
   - 例如：`tracker\.example\.com`

10. **排除Tracker (excludeTracker)**：
    - Tracker地址匹配成功的种子**不满足**条件
    - 支持正则表达式，用于保护特定站点的种子

11. **包含错误信息 (includeErrorMessage)**：
    - 包含错误信息的种子才满足条件
    - 支持正则表达式
    - 用于清理有问题的种子

#### 定时任务
12. **周期 (cron)**：
    - 定时执行的Cron表达式
    - 默认：`0 * * * *`（每小时执行一次）
    - 留空则仅支持手动执行

## 📖 使用说明

### 条件逻辑

#### 组合条件
- **AND逻辑**：所有设置的条件都必须满足
- **条件优先级**：所有条件平等，无优先级
- **空值忽略**：未设置的条件会被忽略

#### 条件示例

**删除大文件旧种子**：
```
最小体积: 10 GB
最少做种时间: 168 小时 (7天)
最低分享率: 2.0
```

**清理错误种子**：
```
包含错误信息: .*error.*|.*timeout.*|.*不存在.*
```

**按站点删除**：
```
包含Tracker: tracker\.oldsite\.com
最少做种时间: 72 小时 (3天)
```

### 执行流程

1. **种子扫描**：
   - 连接指定的下载器
   - 获取所有种子的详细信息
   - 包括大小、状态、标签、路径等

2. **条件匹配**：
   - 逐个检查每个种子是否满足所有条件
   - 应用正则表达式匹配（如设置）
   - 生成符合条件的种子列表

3. **执行删除**：
   - 根据选择的动作删除种子
   - 记录删除操作到日志
   - 统计删除结果

### 定时任务配置

#### Cron表达式示例

```bash
# 每小时执行一次
0 * * * *

# 每天凌晨3点执行
0 3 * * *

# 每周日凌晨2点执行
0 2 * * 0

# 每月1日凌晨4点执行
0 4 1 * *
```

> 📖 **详细说明**：关于Cron表达式的完整语法和更多示例，请参考：[Cron表达式说明文档](/docs/other/cron_rule)

### 操作功能

#### 运行一次
- 立即执行一次删种检查
- 不受定时任务设置影响
- 可用于测试删种规则或手动清理

## ⚠️ 注意事项

### 使用建议

1. **谨慎设置规则**：
   - 首次使用建议设置宽松的条件
   - 先使用"删除种子"动作测试规则
   - 确认规则正确后再使用"删除种子和数据"

2. **重要数据保护**：
   - 使用"排除Tracker"保护重要站点种子
   - 通过标签管理重要种子
   - 定期备份重要的种子文件

3. **合理设置时间**：
   - 做种时间不宜设置过短
   - 考虑不同站点的做种要求
   - 平衡存储空间和做种义务

### 安全提醒

1. **数据不可恢复**：
   - "删除种子和数据"操作不可逆
   - 重要数据请提前备份
   - 建议先用"删除种子"测试

2. **正则表达式**：
   - 测试正则表达式的正确性
   - 避免过于宽泛的匹配模式
   - 使用在线工具验证正则语法

3. **下载器负载**：
   - 大量种子删除可能影响下载器性能
   - 避免在下载器繁忙时执行
   - 合理设置执行频率

### 故障排除

1. **删除失败**：
   - 检查下载器连接状态
   - 确认下载器API权限
   - 查看错误日志获取详细信息

2. **条件不生效**：
   - 确认所有条件都正确设置
   - 检查单位换算（GB、小时、分钟）
   - 验证正则表达式语法

3. **误删种子**：
   - 立即停止自动删种
   - 检查删种日志
   - 从备份恢复种子文件

## 📊 使用效果

### 操作统计
- **扫描种子数**：检查的种子总数
- **符合条件数**：满足删除条件的种子数
- **删除成功数**：实际删除成功的种子数
- **释放空间**：删除数据释放的存储空间

### 管理效果
- **存储优化**：自动释放存储空间
- **性能提升**：减少下载器负载
- **规范管理**：保持种子库整洁

## 🔗 相关链接

- [修仙秘籍主页](/docs/cultivation_secrets/main/)
- [Cron表达式说明](/docs/other/cron_rule)
- [下载器站点标签](/docs/cultivation_secrets/downloader_site_tag/)

---

🎯 **提示**：自动删种功能具有不可逆性，建议先使用"删除种子"模式测试规则，确认无误后再使用"删除种子和数据"。
